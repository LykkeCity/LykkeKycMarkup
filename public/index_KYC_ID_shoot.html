
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 ie7"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9 ie8"> <![endif]-->
<!--[if IE 9]>         <html class="no-js ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js">
<!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Lykke â€“ The Future of Markets</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="manifest.json">
  <link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
  <meta name="theme-color" content="#ffffff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" href="/css/vendor/bootstrap-custom.min.css">
  <link rel="stylesheet" href="/css/styles.css">
  <!--[if lte IE 9]>
  <script type="text/javascript" src="js/vendor/html5shiv.js"></script>
  <![endif]-->



</head>
<body>
<aside class="menu_overlay"></aside>
<aside class="sidebar_menu">
  <div class="sidebar_menu__inner">
    <div class="sidebar_menu__header">
      <button class="btn btn--icon btn_close_menu">
        <i class="icon icon--close"></i>
      </button>
      <div class="header_logo">
        <a href="/">
          <img class="header_logo__img" src="img/lykke_new.svg" height="40" alt="lykke_logo">
        </a>
      </div>
    </div>
    <div class="sidebar_menu__body">
      <ul class="main_projects_list">
        <li class="main_projects_list__item">
          <a href="https://www.lykke.com/" target="_blank" class="main_projects_list__link">
            <div class="main_projects_list__img">
              <img src="/img/lykke_wallet_logo.svg" alt="lykke_wallet_logo" width="50">
            </div>
            <div class="main_projects_list__content">
              <div class="main_projects_list__title">Lykke<span>Wallet</span></div>
              <div class="main_projects_list__text">
                Trade FX and Digital Assets
              </div>
            </div>
          </a>
        </li>
        <li class="main_projects_list__item">
          <a href="https://streams.lykke.com/" target="_blank" class="main_projects_list__link">
            <div class="main_projects_list__img">
              <img src="/img/streams_logo.svg" alt="streams_logo" width="50">
            </div>
            <div class="main_projects_list__content">
              <div class="main_projects_list__title">Lykke<span>Streams</span></div>
              <div class="main_projects_list__text">
                Collaboration platform. Here the great ideas meet bright minds
              </div>
            </div>
          </a>
        </li>
        <li class="main_projects_list__item">
          <a href="https://blockchainexplorer.lykke.com/" target="_blank" class="main_projects_list__link">
            <div class="main_projects_list__img">
              <img src="/img/bl_explorer_logo.svg" alt="bl_explorer_logo" width="50">
            </div>
            <div class="main_projects_list__content">
              <div class="main_projects_list__title">Blockchain<span>Explorer</span></div>
              <div class="main_projects_list__text">
                Explore the Blockchain. Search transaction, assets, addresses or blocks
              </div>
            </div>
          </a>
        </li>
        <li class="main_projects_list__item">
          <a href="" target="_blank" class="main_projects_list__link">
            <div class="main_projects_list__img">
              <img src="/img/issuer_portal_logo.svg" alt="issuer_portal_logo" width="50">
            </div>
            <div class="main_projects_list__content">
              <div class="main_projects_list__title">Issuer<span>Portal</span></div>
              <div class="main_projects_list__text">
                Create and manage your digital assets
              </div>
            </div>
          </a>
        </li>
      </ul>
    </div>
    <div class="sidebar_menu__footer">
      <ul class="social">
        <li><a href="https://www.facebook.com/LykkeCity" target="_blank" class="social__item" rel="noopener noreferrer"><i class="icon icon--fb_simple"></i><span> Facebook</span></a></li>
        <li><a href="https://twitter.com/LykkeCity" target="_blank" class="social__item" rel="noopener noreferrer"><i class="icon icon--tw"></i><span> Twitter</span></a></li>
        <li><a href="http://instagram.com/lykkecity" target="_blank" class="social__item" rel="noopener noreferrer"><i class="icon icon--instagram"></i><span> Instagram</span></a></li>
        <li><a href="https://www.youtube.com/c/LykkeX" target="_blank" class="social__item" rel="noopener noreferrer"><i class="icon icon--youtube"></i><span> Youtube</span></a></li>
        <li><a href="https://www.linkedin.com/company/lykke" target="_blank" class="social__item" rel="noopener noreferrer"><i class="icon icon--linkedin-icn"></i><span> Linkedin</span></a></li>
        <li><a href="https://www.reddit.com/r/lykke/" target="_blank" class="social__item"><i class="icon icon--reddit"></i><span> Reddit</span></a></li>
        <li><a href="https://t.co/TmjMYnQD7T" target="_blank" class="social__item" rel="noopener noreferrer"><i class="icon icon--telegram"></i><span> Telegram</span></a></li>
        <li><a href="http://lykkecommunity.herokuapp.com" target="_blank" class="social__item" rel="noopener noreferrer"><i class="icon icon--slack"></i><span> Slack</span></a></li>
      </ul>
    </div>
  </div>
</aside>
<div class="header_container">
  <header class="header">
    <div class="container">
      <div class="header__menu_button">
        <button class="btn btn_menu btn--icon" type="button">
          <span></span>
        </button>
      </div>
      <div class="header__logo header_logo">
        <a href="/">
          <img class="header_logo__img" src="/img/lykke_new.svg" height="36" alt="lykke_logo">
        </a>
      </div>
      <div class="header__actions header_actions pull-right">
        <!--div class="header_actions__logout visible-xs pull-right">
          <a href="/Home/LogOut" class="btn btn--icon btn_logout">
            <i class="icon icon--exit"></i>
          </a>
        </div-->
        <div class="header_actions__login header_login pull-right">
          <div class="header_actions__login header_login pull-right">
            <div class="header_user dropdown__control">
              <a href="#">
                <div class="header_user__img">
                  <img src="/img/user_default.svg" width="40" alt="user_image">
                </div>
                <div class="header_login__title">Yuliya</div>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>
</div>

<article class="content page page_kyc">
  <section class="section section--padding">
    <div class="container">
      <div class="row">
        <div class="col-sm-8 col-lg-8 automargin">
          <div class="page__header">
            <h1 class="text-center page__title">KYC procedure</h1>
            <h3 class="h3 page__subtitle">Verify your account</h3>
          </div>
          <p class="lead">Lykke requires additional user information before any deposits or withdrawals can be made in order to meet KYC/AML legal requirement multiple tier levels of funding limits, each with increasing amounts of deposit/withdraw limits.</p>

          <div class="steps_list">
            <div class="steps_item steps_item--active">
              <div class="steps_item__title">Photo of your ID</div>
              <div class="steps_item__content">
                <div class="checkboxes_group">
                  <div class="row">
                    <div class="col-sm-4">
                      <div class="form-group">
                        <div class="radio btn-block">
                          <input type="radio" name="doc" id="radio" class="radio__control" value="Passport" checked>
                          <label for="radio" class="form-control control-label radio__label">
                            <i class="icon icon--passport"></i>
                            Passport
                          </label>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-4">
                      <div class="form-group">
                        <div class="radio btn-block">
                          <input type="radio" name="doc" id="radio1" class="radio__control" value="ID">
                          <label for="radio1" class="form-control control-label radio__label">
                            <i class="icon icon--id"></i>
                            ID
                          </label>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-4">
                      <div class="form-group">
                        <div class="radio btn-block">
                          <input type="radio" name="doc" id="radio2" class="radio__control" value="DriverLicense">
                          <label for="radio2" class="form-control control-label radio__label">
                            <i class="icon icon--driver_license"></i>
                            Driver license
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <ul>
                  <li>Driving license should display a photograph, full name and date of birth</li>
                  <li>Image covering whole document should be well lit and in focus</li>
                  <li>Driving license and Proof of Address should be separate documents</li>
                </ul>

                <div class="camera_item">
                  <div class="camera_stream">
                    <div class="camera_stream__frame _camera_frame"></div>
                    <div class="camera_stream__wrapper">
                      <div class="camera_stream__front">
                        <img class="camera_stream__snap camera_stream__snap--front _camera_snap">
                      </div>
                      <div class="camera_stream__back">
                        <img class="camera_stream__snap camera_stream__snap--back _camera_snap_back">
                      </div>
                    </div>
                    <video class="camera_stream__video _camera_video" playsinline></video>
                    <p class="camera_stream__title _camera_title"></p>
                    <p class="camera_stream__message _camera_message"></p>
                    <a href="#" class="btn btn--circle camera_stream__shoot _take_photo" title="Take Photo"><i class="icon icon--photo"></i></a>
                    <div class="camera_stream__controls _camera_controls">
                      <button type="button" class="btn btn--flat camera_stream__delete _delete_photo" title="Reshoot">
                        <span class="camera_stream__delete_text">Retake</span>
                        <span class="btn btn--circle"><i class="icon icon--photo"></i></span>
                      </button>
                    </div>
                    <button type="button" class="btn btn--flat camera_stream__back_btn _rotate_side" data-toggle-text="Front side" v-show="documents.TypeId != 'Passport'">
                      <i class="icon icon--exchange"></i>
                      <span class="_text">Back side</span>
                    </button>
                    <canvas></canvas>
                  </div>
                </div>

                <div class="steps_item__button">
                  <button class="btn btn--primary" type="button" disabled>Submit</button>
                </div>
              </div>
            </div>

            <div class="steps_item">
              <div class="steps_item__title">Address</div>
            </div>

            <div class="steps_item">
              <div class="steps_item__title">Proof of funds</div>
            </div>

            <div class="steps_item">
              <div class="steps_item__title">Selfie</div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>
</article>

<script src="/js/vendor/jquery.min.js"></script>
<script src="/js/vendor/bootstrap.min.js"></script>
<script src="/js/vendor/vue.min.js"></script>
<!-- build:js js/functions.js -->
<script src="/js/functions.js"></script>
<script src="/js/camera.js"></script>
<!-- endbuild -->

<script>
  var _this = "";

  var app = new Vue({
    el: "#webkycflow-vue-app",
    data: {
      documents: [],
      kycStatus: "",

      // Document ID
      documentId: {
        display: false,
        useCamera: true
      },

      displayAddress: false,

      // Document Address
      documentAddress: {
        display: false,
        useCamera: false,
        useFile: false,
        hasFile: false,

        file: {
          name: "",
          extension: "",
          size: "",

          reset: function () {
            this.name = "";
            this.extension = "";
            this.size = "";
          }
        },

        toggleCamera: function () {
          this.useCamera = true;
          this.useFile = false;
          this.hasFile = false;
          this.file.reset();

          $(".x_use_file").val("false");
        },

        toggleFile: function () {
          this.useCamera = false;
          this.useFile = true;

          document.getElementsByClassName("x_file_upload")[0].click();
        },
      },

      // Document Selfie
      documentSelfie: {
        display: false,
        useCamera: true
      }
    },
    methods: {
      convertBytes: function (x) {
        let units = ['bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
        let l = 0, n = parseInt(x, 10) || 0;

        while (n >= 1024 && ++l)
          n = n / 1024;

        return (n.toFixed(n >= 10 || l < 1 ? 0 : 1) + ' ' + units[l]);
      },
      getKycStatus: function () {
        let result = "";

        $.ajax({
          url: '/api/documents/kycstatus', method: 'GET', type: 'json', async: false,
          success: function (data) {
            result = data;
          }
        });

        return result;
      },
      uploadDocuments: function (docModel) {
        var result = false;

        $.ajax({
          url: '/api/documents/upload', method: 'POST', data: docModel, type: 'json', async: false,
          success: function () {
            result = true;
          }
        });

        return result;
      },
      onSubmitId: function () {
        $("#document_submit_id").prop("disabled", true);
        let frontSideResult = false, backSideResult = false;

        let docFrontSide = {};
        docFrontSide.DocumentName = _this.documents.TypeId;
        docFrontSide.DocumentType = "";
        docFrontSide.FileExtension = "png";
        docFrontSide.Data = $(".x_photo_front_side").val();

        let docBackSide = {};
        docBackSide.DocumentName = _this.documents.TypeId;
        docBackSide.DocumentType = "BackSide";
        docBackSide.FileExtension = "png";
        docBackSide.Data = $(".x_photo_back_side").val();

        // frontSideResult = true;
        // backSideResult = true;

        frontSideResult = _this.uploadDocuments(docFrontSide);

        if (_this.documents.TypeId != "Passport") {
          backSideResult = _this.uploadDocuments(docBackSide);
        }
        else {
          backSideResult = true;
        }

        if (frontSideResult && backSideResult) {
          _this.documentId.display = false;

          if (_this.documents.RequireAddress) {
            _this.documentAddress.display = true;
          }
          else if (_this.documents.RequireSelfie) {
            _this.documentSelfie.display = true;
          }
          else {

          }
        }
        else {
          $("#document_submit_id").prop("disabled", false);
        }

        $(".x_photo_front_side").val("");
        $(".x_photo_back_side").val("");
        $(".x_use_file").val("");
        _this.documents.TypeId = "";
      },
      onSubmitAddress: function () {
        _this.documents.TypeId = "";
        $("#document_submit_address").prop("disabled", true);
        let frontSideResult = false;

        let docFrontSide = {};
        docFrontSide.DocumentName = "ProofOfAddress";
        docFrontSide.DocumentType = "";

        // frontSideResult = true;

        if (_this.documentAddress.hasFile) {
          docFrontSide.FileExtension = _this.documentAddress.file.extension;
        }
        else {
          docFrontSide.FileExtension = "png";
        }

        docFrontSide.Data = $(".x_photo_front_side").val();
        frontSideResult = _this.uploadDocuments(docFrontSide);

        if (frontSideResult) {
          _this.documentAddress.display = false;

          if (_this.documents.RequireSelfie) {
            _this.documentSelfie.display = true;
          }
        }
        else {
          $("#document_submit_address").prop("disabled", false);
        }

      },
      onSubmitSelfie: function () {
        _this.documents.TypeId = "";
        $("#document_submit_selfie").prop("disabled", true);
        let frontSideResult = false, submitResult = false;

        let docFrontSide = {};
        docFrontSide.DocumentName = "Selfie";
        docFrontSide.DocumentType = "";
        docFrontSide.FileExtension = "png";
        docFrontSide.Data = $(".x_photo_front_side").val();

        frontSideResult = _this.uploadDocuments(docFrontSide);
        // frontSideResult = true;

        if (frontSideResult) {
          $("#document_submit_selfie").prop("disabled", true);
          _this.documentSelfie.display = false;

          $.ajax({
            url: '/api/documents/submit', method: 'POST', type: 'json', async: true,
            success: function () {
              _this.kycStatus = _this.getKycStatus();
            },
            error: function () {
              _this.documentSelfie.display = true;
              $("#document_submit_selfie").prop("disabled", false);

              _this.kycStatus = _this.getKycStatus();
            }
          });
        }
        else {
          $("#document_submit_selfie").prop("disabled", false);
        }
      },
      getDocuments: function () {
        let result = "";

        $.ajax({
          url: '/api/documents/list', method: 'GET', type: 'json', async: false,
          success: function (data) {
            result = data;
          }
        });

        return result;
      },
      validateFile: function (event, fileInfo) {
        var file = event.target.files[0];

        if (file.size > 3145728) {
          file.value = "";
          fileInfo.reset();

          $(".document_submit").prop("disabled", true);

          $(".x_use_file").val("false");
          this.documentAddress.hasFile = false;

          alert('The maximum file size is 3MB');
          return false;
        }

        var fileName = file.name;
        var idxDot = fileName.lastIndexOf(".") + 1;
        var extFile = fileName.substr(idxDot, fileName.length).toLowerCase();

        if (extFile == "jpg" || extFile == "jpeg" || extFile == "png" || extFile == "pdf") {
          this.documentAddress.hasFile = true;
          $(".document_submit").prop("disabled", false);

          fileInfo.name = file.name;
          fileInfo.extension = extFile;
          fileInfo.size = this.convertBytes(file.size);

          var reader = new FileReader();
          reader.readAsDataURL(file);
          reader.onload = function () {
            $(".x_photo_front_side").val(reader.result);
          };

          $(".x_use_file").val("true");
        }
        else {
          file.value = "";
          fileInfo.reset();

          $(".document_submit").prop("disabled", true);

          $(".x_use_file").val("false");
          this.documentAddress.hasFile = false;

          alert("Only jpg, jpeg, png and pdf files are allowed!");
          return false;
        }
      }
    },
    mounted: function () {
      _this = this;

      _this.kycStatus = _this.getKycStatus();
      _this.documents = _this.getDocuments();

      // if (_this.documents == "") location = "/404";

      if (new Boolean(_this.documents.RequireId) == true) {
        _this.documentId.display = true;
      }
      else if (new Boolean(_this.documents.RequireAddress) == true) {
        _this.documentAddress.display = true;
      }
      else if (new Boolean(_this.documents.RequireSelfie) == true) {
        _this.documentSelfie.display = true;
      }
    },
    updated: function () {
      initCameraModule();
    }
  });
</script>

</body>
</html>
